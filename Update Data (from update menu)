<?php include 'header.php'; ?>

<div id="main-content">
    <h2>Edit Record</h2>

    <!-- Search Form -->
    <form class="post-form" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
        <div class="form-group">
            <label>Id</label>
            <input type="text" name="sid" />
        </div>
        <input class="submit" type="submit" name="showbtn" value="Show" />
    </form>

    <!-- Update Data Form -->
    <form class="post-form" action="updatedata.php" method="post">
        <div class="form-group">

        <?php  
        if (isset($_POST['showbtn'])) {

            $id = $_POST['sid'];

            // DB Connection
            $conn = mysqli_connect("localhost", "root", "", "crud");

            // Fetch student data
            $sql = "SELECT * FROM student WHERE sid = {$id}";
            $result = mysqli_query($conn, $sql);

            if (mysqli_num_rows($result) > 0) {

                while ($row = mysqli_fetch_assoc($result)) {
        ?>

            <label>Name</label>
            <input type="hidden" name="sid" value="<?php echo $row['sid']; ?>" />
            <input type="text" name="sname" value="<?php echo $row['sname']; ?>" />
        </div>

        <div class="form-group">
            <label>Address</label>
            <input type="text" name="saddress" value="<?php echo $row['saddress']; ?>" />
        </div>

        <div class="form-group">
            <label>Class</label>

            <?php 
                // Fetch course list
                $sql1 = "SELECT * FROM course";
                $result1 = mysqli_query($conn, $sql1);

                if (mysqli_num_rows($result1) > 0) { 
            ?>

            <select name="sclass">
                <?php 
                while ($row1 = mysqli_fetch_assoc($result1)) {

                    $selected = ($row['scourse'] == $row1['cid']) ? "selected" : "";

                    echo "<option $selected value='{$row1['cid']}'>{$row1['cname']}</option>";
                }
                ?>
            </select>

            <?php } ?>
        </div>

        <div class="form-group">
            <label>Phone</label>
            <input type="text" name="sphone" value="<?php echo $row['sphone']; ?>" />
        </div>

        <input class="submit" type="submit" value="Update" />

    </form>

    <?php 
                } // end while
            } // end if rows
        } // end if showbtn
    ?>
</div>

</body>
</html>
